<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moldura com Câmera</title>

<style>
body {
    margin: 0;
    overflow: hidden;
    background: black;
}
#camera-area {
    position: relative;
    width: 100vw;
    height: 100vh;
}
video {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
}
#moldura {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
}
#botoes {
    position: absolute;
    bottom: 20px;
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 20px;
}
button {
    padding: 12px 18px;
    font-size: 16px;
    border: none;
    border-radius: 10px;
    background: white;
}
</style>

</head>
<body>

<div id="camera-area">
    <video id="video" autoplay playsinline></video>
    <img id="moldura" src="moldura.png">
</div>

<div id="botoes">
    <button onclick="trocarCamera()">Trocar Câmera</button>
    <button onclick="tirarFoto()">Tirar Foto</button>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script>
let usandoFrontal = true;

async function iniciarCamera() {
    const tipo = usandoFrontal ? "user" : "environment";

    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: tipo }
        });

        const video = document.getElementById("video");
        video.srcObject = stream;

    } catch (e) {
        alert("Erro ao acessar câmera: " + e);
    }
}

function trocarCamera() {
    usandoFrontal = !usandoFrontal;
    iniciarCamera();
}

function tirarFoto() {
    const video = document.getElementById("video");
    const moldura = document.getElementById("moldura");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    ctx.drawImage(moldura, 0, 0, canvas.width, canvas.height);

    const link = document.createElement("a");
    link.download = "foto-moldura.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
}

iniciarCamera();
</script>

</body>
</html>
