<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moldura 9:16</title>

<style>
body {
    margin: 0;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

#container {
    position: relative;
    width: 100vw;
    max-width: 430px; /* largura típica de celular */
    aspect-ratio: 9 / 16; /* AQUI GARANTE 9:16 */
    background: black;
    overflow: hidden;
}

video, #moldura {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover; /* evita distorção */
}

#botoes {
    position: absolute;
    bottom: 20px;
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 20px;
    z-index: 10;
}

button {
    padding: 12px 18px;
    font-size: 16px;
    border: none;
    border-radius: 10px;
    background: white;
}
</style>
</head>

<body>

<div id="container">
    <video id="video" autoplay playsinline></video>
    <img id="moldura" src="moldura.png">

    <div id="botoes">
        <button onclick="trocarCamera()">Trocar Câmera</button>
        <button onclick="tirarFoto()">Tirar Foto</button>
    </div>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script>
let usandoFrontal = true;

async function iniciarCamera() {
    const tipo = usandoFrontal ? "user" : "environment";

    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: {
                facingMode: tipo,
                width: { ideal: 1080 },
                height: { ideal: 1920 }
            }
        });

        document.getElementById("video").srcObject = stream;

    } catch (e) {
        alert("Erro ao acessar câmera: " + e);
    }
}

function trocarCamera() {
    usandoFrontal = !usandoFrontal;
    iniciarCamera();
}

function tirarFoto() {
    const video = document.getElementById("video");
    const moldura = document.getElementById("moldura");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = 1080;
    canvas.height = 1920;

    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    ctx.drawImage(moldura, 0, 0, canvas.width, canvas.height);

    const link = document.createElement("a");
    link.download = "foto-moldura.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
}

iniciarCamera();
</script>

</body>
</html>
